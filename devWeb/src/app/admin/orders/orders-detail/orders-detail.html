<div class="container mt-4">
  <button class="btn btn-outline-secondary mb-3" (click)="goBack()">
    ← Retour à la liste
  </button>

  <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status"></div>
    <p>Chargement de la commande...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <div *ngIf="!loading && order" class="card shadow-sm p-3">
    <h4 class=" ">Commande #{{ order.id }}</h4>
    <p><strong>Client :</strong> {{ order.user?.name || 'Inconnu' }}</p>
    <p><strong>Date :</strong> {{ order.created_at | date:'short' }}</p>
    <p><strong>Total :</strong> {{ order.total | currency:'EUR' }}</p>

    <div class="mt-3">
      <label for="statusSelect" class="form-label fw-bold">Statut :</label>
      <select id="statusSelect" class="form-select w-auto d-inline-block" [(ngModel)]="selectedStatus"
        [disabled]="order.status === 'cancelled' || order.status === 'completed'">
        <option *ngFor="let s of statuses" [value]="s">
          {{ formatStatus(s) }}
        </option>
      </select>

      <button class="btn btn-primary ms-2" (click)="updateStatus()" [disabled]="selectedStatus === order.status">
        Mettre à jour
      </button>
      <button class="btn btn-outline-danger ms-2" (click)="deleteOrder(order.id)">
        <i class="bi bi-trash"></i> Supprimer
      </button>
    </div>

    <hr />
    <h5>Articles</h5>
    <ul class="list-group">
      <li *ngFor="let item of order.items" class="list-group-item d-flex justify-content-between">
        <span>{{ item.product.name }} (x{{ item.quantity }})</span>
        <span>{{ item.price | currency:'EUR' }}</span>
      </li>
    </ul>
  </div>
</div>