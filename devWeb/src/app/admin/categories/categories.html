<div class="container mt-4">
  <h2 class="mb-4">Gestion des catégories</h2>

    <div *ngIf="loading" class="text-center">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2">Chargement...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <!-- Formulaire d'ajout -->
  <div class="input-group mb-3 w-50" *ngIf="!loading && categories.length">
    <input
      type="text"
      class="form-control"
      placeholder="Nouvelle catégorie"
      [(ngModel)]="newCategory.name"
    />
    <button class="btn btn-primary" (click)="addCategory()">Ajouter</button>
  </div>

  <!-- Liste des catégories -->
  <table class="table table-hover table-bordered align-middle" *ngIf="!loading && categories.length">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Nom</th>
        <th class="text-end">Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let category of categories">
        <td>{{ category.id }}</td>
        <td *ngIf="editingCategory?.id !== category.id">{{ category.name }}</td>

        <!-- Mode édition -->
        <td *ngIf="editingCategory?.id === category.id">
          <input
            type="text"
            class="form-control"
            [(ngModel)]="editingCategory.name"
          />
        </td>

        <td class="text-end">
          <ng-container *ngIf="editingCategory?.id !== category.id">
            <button class="btn btn-sm btn-warning me-2" (click)="startEdit(category)">
              <i class="bi bi-pencil"></i> Modifier
            </button>
            <button class="btn btn-sm btn-danger" (click)="deleteCategory(category.id)">
              <i class="bi bi-trash"></i> Supprimer
            </button>
          </ng-container>

          <ng-container *ngIf="editingCategory?.id === category.id">
            <button class="btn btn-sm btn-success me-2" (click)="saveEdit()">
              <i class="bi bi-check2"></i> Sauver
            </button>
            <button class="btn btn-sm btn-secondary" (click)="cancelEdit()">
              <i class="bi bi-x"></i> Annuler
            </button>
          </ng-container>
        </td>
      </tr>
    </tbody>
  </table>
</div>
